{"remainingRequest":"E:\\Front\\vue-manage-system-dev\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Front\\vue-manage-system-dev\\src\\components\\page\\tourist\\test.vue?vue&type=style&index=0&id=8cba7522&lang=scss&scoped=true&","dependencies":[{"path":"E:\\Front\\vue-manage-system-dev\\src\\components\\page\\tourist\\test.vue","mtime":1584524039829},{"path":"E:\\Front\\vue-manage-system-dev\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"E:\\Front\\vue-manage-system-dev\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\Front\\vue-manage-system-dev\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\Front\\vue-manage-system-dev\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Front\\vue-manage-system-dev\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Front\\vue-manage-system-dev\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.camera_outer{\n    position: relative;\n    overflow: hidden;\n    background: url(\"../../../assets/img/1.jpg\") no-repeat center;\n    background-size: 100%;\n    video,canvas,.tx_img{\n        -moz-transform:scaleX(-1);\n        -webkit-transform:scaleX(-1);\n        -o-transform:scaleX(-1);\n        transform:scaleX(-1);\n    }\n    .btn_camera{\n        position: absolute;\n        bottom: 4px;\n        left: 0;\n        right: 0;\n        height: 50px;\n        background-color: rgba(0,0,0,0.3);\n        line-height: 50px;\n        text-align: center;\n        color: #ffffff;\n    }\n    .bg_r_img{\n        position: absolute;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        top: 0;\n    }\n    .img_bg_camera{\n        position: absolute;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        top: 0;\n        img{\n            width: 100%;\n            height: 100%;\n        }\n        .img_btn_camera{\n            position: absolute;\n            bottom: 0;\n            left: 0;\n            right: 0;\n            height: 50px;\n            line-height: 50px;\n            text-align: center;\n            background-color: rgba(0,0,0,0.3);\n            color: #ffffff;\n            .loding_img{\n                width: 50px;\n                height: 50px;\n            }\n        }\n    }\n}\n",{"version":3,"sources":["test.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"test.vue","sourceRoot":"src/components/page/tourist","sourcesContent":["<template>\r\n    <div class=\"camera_outer\">\r\n        <video id=\"videoCamera\" :width=\"videoWidth\" :height=\"videoHeight\" autoplay></video>\r\n        <canvas style=\"display:none;\" id=\"canvasCamera\" :width=\"videoWidth\" :height=\"videoHeight\" ></canvas>\r\n\r\n        <div v-if=\"imgSrc\" class=\"img_bg_camera\">\r\n            <img :src=\"imgSrc\" alt=\"\" class=\"tx_img\">\r\n        </div>\r\n        <button @click=\"getCompetence()\">打开摄像头</button>\r\n        <button @click=\"stopNavigator()\">关闭摄像头</button>\r\n        　　　　　<button @click=\"setImage()\">拍照</button>\r\n\r\n\r\n\r\n    </div>\r\n</template>\r\n<script>\r\n    export default {\r\n        data () {\r\n            return {\r\n                videoWidth: 3000,\r\n                videoHeight: 300,\r\n                imgSrc: '',\r\n                thisCancas: null,\r\n                thisContext: null,\r\n                thisVideo: null,\r\n            }\r\n        },\r\n        methods: {\r\n// 调用权限（打开摄像头功能）\r\n            getCompetence () {\r\n                var _this = this\r\n                this.thisCancas = document.getElementById('canvasCamera')\r\n                this.thisContext = this.thisCancas.getContext('2d')\r\n                this.thisVideo = document.getElementById('videoCamera')\r\n                // 旧版本浏览器可能根本不支持mediaDevices，我们首先设置一个空对象\r\n                if (navigator.mediaDevices === undefined) {\r\n                    navigator.mediaDevices = {}\r\n                }\r\n                // 一些浏览器实现了部分mediaDevices，我们不能只分配一个对象\r\n                // 使用getUserMedia，因为它会覆盖现有的属性。\r\n                // 这里，如果缺少getUserMedia属性，就添加它。\r\n                if (navigator.mediaDevices.getUserMedia === undefined) {\r\n                    navigator.mediaDevices.getUserMedia = function (constraints) {\r\n                        // 首先获取现存的getUserMedia(如果存在)\r\n                        var getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.getUserMedia\r\n                        // 有些浏览器不支持，会返回错误信息\r\n                        // 保持接口一致\r\n                        if (!getUserMedia) {\r\n                            return Promise.reject(new Error('getUserMedia is not implemented in this browser'))\r\n                        }\r\n                        // 否则，使用Promise将调用包装到旧的navigator.getUserMedia\r\n                        return new Promise(function (resolve, reject) {\r\n                            getUserMedia.call(navigator, constraints, resolve, reject)\r\n                        })\r\n                    }\r\n                }\r\n                var constraints = { audio: false, video: { width: this.videoWidth, height: this.videoHeight, transform: 'scaleX(-1)' } }\r\n                navigator.mediaDevices.getUserMedia(constraints).then(function (stream) {\r\n                    // 旧的浏览器可能没有srcObject\r\n                    if ('srcObject' in _this.thisVideo) {\r\n                        _this.thisVideo.srcObject = stream\r\n                    } else {\r\n                        // 避免在新的浏览器中使用它，因为它正在被弃用。\r\n                        _this.thisVideo.src = window.URL.createObjectURL(stream)\r\n                    }\r\n                    _this.thisVideo.onloadedmetadata = function (e) {\r\n                        _this.thisVideo.play()\r\n                    }\r\n                }).catch(err => {\r\n                    console.log(err)\r\n                })\r\n            },\r\n//  绘制图片（拍照功能）\r\n\r\n            setImage () {\r\n                var _this = this\r\n                // 点击，canvas画图\r\n                _this.thisContext.drawImage(_this.thisVideo, 0, 0, _this.videoWidth, _this.videoHeight)\r\n                // 获取图片base64链接\r\n                var image = this.thisCancas.toDataURL('image/png')\r\n                _this.imgSrc = image\r\n                this.$emit('refreshDataList', this.imgSrc)\r\n            },\r\n// base64转文件\r\n\r\n            dataURLtoFile (dataurl, filename) {\r\n                var arr = dataurl.split(',')\r\n                var mime = arr[0].match(/:(.*?);/)[1]\r\n                var bstr = atob(arr[1])\r\n                var n = bstr.length\r\n                var u8arr = new Uint8Array(n)\r\n                while (n--) {\r\n                    u8arr[n] = bstr.charCodeAt(n)\r\n                }\r\n                return new File([u8arr], filename, { type: mime })\r\n            },\r\n// 关闭摄像头\r\n\r\n            stopNavigator () {\r\n                this.thisVideo.srcObject.getTracks()[0].stop()\r\n            }\r\n        },\r\n\r\n    }\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n    .camera_outer{\r\n        position: relative;\r\n        overflow: hidden;\r\n        background: url(\"../../../assets/img/1.jpg\") no-repeat center;\r\n        background-size: 100%;\r\n        video,canvas,.tx_img{\r\n            -moz-transform:scaleX(-1);\r\n            -webkit-transform:scaleX(-1);\r\n            -o-transform:scaleX(-1);\r\n            transform:scaleX(-1);\r\n        }\r\n        .btn_camera{\r\n            position: absolute;\r\n            bottom: 4px;\r\n            left: 0;\r\n            right: 0;\r\n            height: 50px;\r\n            background-color: rgba(0,0,0,0.3);\r\n            line-height: 50px;\r\n            text-align: center;\r\n            color: #ffffff;\r\n        }\r\n        .bg_r_img{\r\n            position: absolute;\r\n            bottom: 0;\r\n            left: 0;\r\n            right: 0;\r\n            top: 0;\r\n        }\r\n        .img_bg_camera{\r\n            position: absolute;\r\n            bottom: 0;\r\n            left: 0;\r\n            right: 0;\r\n            top: 0;\r\n            img{\r\n                width: 100%;\r\n                height: 100%;\r\n            }\r\n            .img_btn_camera{\r\n                position: absolute;\r\n                bottom: 0;\r\n                left: 0;\r\n                right: 0;\r\n                height: 50px;\r\n                line-height: 50px;\r\n                text-align: center;\r\n                background-color: rgba(0,0,0,0.3);\r\n                color: #ffffff;\r\n                .loding_img{\r\n                    width: 50px;\r\n                    height: 50px;\r\n                }\r\n            }\r\n        }\r\n    }\r\n</style>\r\n"]}]}