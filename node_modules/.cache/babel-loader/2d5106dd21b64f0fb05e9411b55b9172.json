{"remainingRequest":"E:\\Front\\vue-manage-system-dev\\node_modules\\babel-loader\\lib\\index.js!E:\\Front\\vue-manage-system-dev\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\Front\\vue-manage-system-dev\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Front\\vue-manage-system-dev\\src\\components\\pages\\shared\\SearchBox.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\Front\\vue-manage-system-dev\\src\\components\\pages\\shared\\SearchBox.vue","mtime":1581686428000},{"path":"E:\\Front\\vue-manage-system-dev\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Front\\vue-manage-system-dev\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\Front\\vue-manage-system-dev\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Front\\vue-manage-system-dev\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _toConsumableArray from \"E:\\\\Front\\\\vue-manage-system-dev\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.string.iterator\";\nimport \"core-js/modules/es6.set\";\nimport \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport storageUtil from \"../../../assets/script/util/storageUtil\";\nimport { off, on } from \"../../../assets/script/util/domUtil\";\nexport default {\n  props: {\n    historyThreshold: {\n      type: Number,\n      default: 5\n    }\n  },\n  data: function data() {\n    return {\n      tag: \"\",\n      searchHistory: [],\n      searchHistoryIndex: -1\n    };\n  },\n  computed: {\n    searchHistoryReverse: function searchHistoryReverse() {\n      return this.searchHistory.reverse();\n    }\n  },\n  mounted: function mounted() {\n    var _this = this;\n\n    this.$nextTick(function () {\n      _this.searchHistory = storageUtil.localGet(\"searchHistory\", []);\n    });\n  },\n  methods: {\n    search: function search() {\n      if (this.tag) {\n        var searchHistorySet = new Set(this.searchHistory);\n        searchHistorySet.delete(this.tag);\n        searchHistorySet.add(this.tag);\n        this.searchHistory = storageUtil.localSet(\"searchHistory\", _toConsumableArray(searchHistorySet));\n      }\n\n      this.$router.push(\"/picture/search/\".concat(encodeURIComponent(this.tag)));\n    },\n    onKey: function onKey(event) {\n      if (event.key !== \"ArrowUp\" && event.key !== \"ArrowDown\") return;\n\n      if (event.key === \"ArrowUp\") {\n        this.searchHistoryIndex <= 0 ? this.searchHistoryIndex = this.searchHistory.length - 1 : this.searchHistoryIndex--;\n      } else if (event.key === \"ArrowDown\") {\n        this.searchHistoryIndex >= this.searchHistory.length - 1 ? this.searchHistoryIndex = 0 : this.searchHistoryIndex++;\n      }\n\n      this.tag = this.searchHistory[this.searchHistoryIndex];\n    },\n    showHistory: function showHistory() {\n      on(document, \"keydown\", this.onKey);\n    },\n    hideHistory: function hideHistory() {\n      off(document, \"keydown\", this.onKey);\n    }\n  }\n};",{"version":3,"sources":["SearchBox.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4CA,OAAA,WAAA;AACA,SAAA,GAAA,EAAA,EAAA;AAEA,eAAA;AACA,EAAA,KAAA,EAAA;AACA,IAAA,gBAAA,EAAA;AACA,MAAA,IAAA,EAAA,MADA;AAEA,MAAA,OAAA,EAAA;AAFA;AADA,GADA;AAOA,EAAA,IAPA,kBAOA;AACA,WAAA;AACA,MAAA,GAAA,EAAA,EADA;AAEA,MAAA,aAAA,EAAA,EAFA;AAGA,MAAA,kBAAA,EAAA,CAAA;AAHA,KAAA;AAKA,GAbA;AAcA,EAAA,QAAA,EAAA;AACA,IAAA,oBADA,kCACA;AACA,aAAA,KAAA,aAAA,CAAA,OAAA,EAAA;AACA;AAHA,GAdA;AAmBA,EAAA,OAnBA,qBAmBA;AAAA;;AACA,SAAA,SAAA,CAAA,YAAA;AACA,MAAA,KAAA,CAAA,aAAA,GAAA,WAAA,CAAA,QAAA,CAAA,eAAA,EAAA,EAAA,CAAA;AACA,KAFA;AAGA,GAvBA;AAwBA,EAAA,OAAA,EAAA;AACA,IAAA,MADA,oBACA;AACA,UAAA,KAAA,GAAA,EAAA;AACA,YAAA,gBAAA,GAAA,IAAA,GAAA,CAAA,KAAA,aAAA,CAAA;AACA,QAAA,gBAAA,CAAA,MAAA,CAAA,KAAA,GAAA;AACA,QAAA,gBAAA,CAAA,GAAA,CAAA,KAAA,GAAA;AACA,aAAA,aAAA,GAAA,WAAA,CAAA,QAAA,CAAA,eAAA,qBACA,gBADA,EAAA;AAGA;;AACA,WAAA,OAAA,CAAA,IAAA,2BAAA,kBAAA,CAAA,KAAA,GAAA,CAAA;AACA,KAXA;AAYA,IAAA,KAZA,iBAYA,KAZA,EAYA;AACA,UAAA,KAAA,CAAA,GAAA,KAAA,SAAA,IAAA,KAAA,CAAA,GAAA,KAAA,WAAA,EAAA;;AACA,UAAA,KAAA,CAAA,GAAA,KAAA,SAAA,EAAA;AACA,aAAA,kBAAA,IAAA,CAAA,GACA,KAAA,kBAAA,GAAA,KAAA,aAAA,CAAA,MAAA,GAAA,CADA,GAEA,KAAA,kBAAA,EAFA;AAGA,OAJA,MAIA,IAAA,KAAA,CAAA,GAAA,KAAA,WAAA,EAAA;AACA,aAAA,kBAAA,IAAA,KAAA,aAAA,CAAA,MAAA,GAAA,CAAA,GACA,KAAA,kBAAA,GAAA,CADA,GAEA,KAAA,kBAAA,EAFA;AAGA;;AACA,WAAA,GAAA,GAAA,KAAA,aAAA,CAAA,KAAA,kBAAA,CAAA;AACA,KAxBA;AAyBA,IAAA,WAzBA,yBAyBA;AACA,MAAA,EAAA,CAAA,QAAA,EAAA,SAAA,EAAA,KAAA,KAAA,CAAA;AACA,KA3BA;AA4BA,IAAA,WA5BA,yBA4BA;AACA,MAAA,GAAA,CAAA,QAAA,EAAA,SAAA,EAAA,KAAA,KAAA,CAAA;AACA;AA9BA;AAxBA,CAAA","sourcesContent":["<template>\n  <form class=\"search-box\" @submit.prevent=\"search\">\n    <Field\n      v-model=\"tag\"\n      v-popover:history\n      color=\"primary\"\n      placeholder=\"请输入标签搜索\"\n      shadow\n      big\n    >\n      <template #right>\n        <Btn v-tooltip=\"`搜索`\" flat icon type=\"submit\" @click.stop=\"() => {}\">\n          <i class=\"icon ali-icon-search\"></i>\n        </Btn>\n      </template>\n    </Field>\n    <Popper\n      ref=\"history\"\n      trigger=\"click\"\n      click-reference-keep\n      @show=\"showHistory\"\n      @hide=\"hideHistory\"\n    >\n      <ul class=\"history-box\">\n        <template v-for=\"(item, index) in searchHistoryReverse\">\n          <li\n            v-if=\"index < historyThreshold\"\n            :key=\"index\"\n            :class=\"{ active: index === searchHistoryIndex }\"\n          >\n            <nuxt-link\n              v-ripple\n              :to=\"`/picture/search/${encodeURIComponent(item)}`\"\n            >\n              {{ item }}\n            </nuxt-link>\n          </li>\n        </template>\n      </ul>\n    </Popper>\n  </form>\n</template>\n\n<script>\nimport storageUtil from \"../../../assets/script/util/storageUtil\"\nimport { off, on } from \"../../../assets/script/util/domUtil\"\n\nexport default {\n  props: {\n    historyThreshold: {\n      type: Number,\n      default: 5\n    }\n  },\n  data() {\n    return {\n      tag: \"\",\n      searchHistory: [],\n      searchHistoryIndex: -1\n    }\n  },\n  computed: {\n    searchHistoryReverse() {\n      return this.searchHistory.reverse()\n    }\n  },\n  mounted() {\n    this.$nextTick(() => {\n      this.searchHistory = storageUtil.localGet(\"searchHistory\", [])\n    })\n  },\n  methods: {\n    search() {\n      if (this.tag) {\n        const searchHistorySet = new Set(this.searchHistory)\n        searchHistorySet.delete(this.tag)\n        searchHistorySet.add(this.tag)\n        this.searchHistory = storageUtil.localSet(\"searchHistory\", [\n          ...searchHistorySet\n        ])\n      }\n      this.$router.push(`/picture/search/${encodeURIComponent(this.tag)}`)\n    },\n    onKey(event) {\n      if (event.key !== \"ArrowUp\" && event.key !== \"ArrowDown\") return\n      if (event.key === \"ArrowUp\") {\n        this.searchHistoryIndex <= 0\n          ? (this.searchHistoryIndex = this.searchHistory.length - 1)\n          : this.searchHistoryIndex--\n      } else if (event.key === \"ArrowDown\") {\n        this.searchHistoryIndex >= this.searchHistory.length - 1\n          ? (this.searchHistoryIndex = 0)\n          : this.searchHistoryIndex++\n      }\n      this.tag = this.searchHistory[this.searchHistoryIndex]\n    },\n    showHistory() {\n      on(document, \"keydown\", this.onKey)\n    },\n    hideHistory() {\n      off(document, \"keydown\", this.onKey)\n    }\n  }\n}\n</script>\n\n<style type=\"text/less\" lang=\"less\" scoped>\n@import \"../../../assets/style/color\";\n@import \"../../../assets/style/config\";\n@import \"../../../assets/style/mixin\";\n\n@input-size: 550px;\n\n.search-box {\n  font-size: 0;\n  .input {\n    width: @input-size;\n  }\n}\n\n.history-box {\n  width: @input-size;\n  li {\n    &.active,\n    &:hover {\n      background-color: @font-color-dark-line;\n    }\n    a {\n      line-height: 40px;\n      padding: 0 15px;\n      display: block;\n    }\n  }\n}\n</style>\n"],"sourceRoot":"src/components/pages/shared"}]}